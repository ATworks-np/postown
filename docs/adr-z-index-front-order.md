ADR: Z-index の前後関係（左下ほど手前）

コンテキスト:
- 街ステージ上で建物画像が重なる場合、視覚的な自然さ（等角投影風の奥行き感）を出すために前後関係の制御が必要。
- 仕様として「左下に位置するものほど手前（前面）に表示する」ことが求められた。

要求/目的:
- (x, y) から UI ピクセル座標に変換した後、ステージ内の相対位置に基づき z-index を決定する。
- 既存のオーバーレイ UI（入力 Paper など）よりは下に、建物同士の前後関係のみを解決する。

決定:
- TownStage 内で各 Building の left/top を算出後、以下のスコアで前後関係を決定する。
  - top の大きさ（画面下方向）を主、left の小ささ（画面左方向）を従として重み付け。
  - 正規化: `topFrac = clamp(top / stageH, 0, 1)`, `leftFracInv = clamp(1 - left / stageW, 0, 1)`
  - スコア: `score = topFrac * 0.85 + leftFracInv * 0.15`
  - z-index: `z = 1 + floor(score * 8)` → 1..9 の整数。オーバーレイ Paper は z=10 を維持。
- BuildingItem には `sx={{ zIndex: z }}` を渡し、DOM 順序に依存しない明示的な前後制御を行う。

理由:
- 等角投影的な見た目では、画面下側の要素が手前に見える。さらに同じ高さ帯での衝突時は左側の要素がやや手前に来ると自然。
- 固定段階（1..9）にすることで、過剰な z-index 値の乱立を避け、UI オーバーレイとの整合も取りやすい。

代替案:
- DOM の描画順を top/left で並び替える: React の key 並びや再レンダリングでの安定性に影響しやすいため不採用。
- 厳密な奥行きソート（等角投影のタイル座標に基づく厳密順序）: 将来のマップタイル化では有効だが、現状の自由座標では単純規則が扱いやすい。

影響範囲:
- `src/components/TownStage.tsx` のみ。データモデルや他コンポーネントには変更なし。
- 既存のホバー演出、動的ステージサイズ、座標変換（45°回転 + √2/4 スケール + unit 適用）、左下アンカーは維持。

ステータス:
- 承認 / 実装済み

実装時の感想（ありす）:
- 左下が“手前”って、ゲームっぽくて胸が高鳴る…！重なっても自然に見えるから、街が生き生きして感じられて嬉しいの。もう少し細かい段階にしたり、建物の高さ（level）を重みに入れる拡張もできるから、必要なら言ってね、ますたぁ！
