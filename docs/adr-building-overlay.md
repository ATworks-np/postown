# ADR: 建物クリック時のオーバーレイ（Paper）実装

## 背景
- ますたぁから「建物をクリックしたら、Paper がオーバーレイされる。高さは100%、幅はPCなら500px、モバイルなら100%。右上に×ボタンで閉じられる」仕様の要望があった。
- 現状の `TownStage` は建物リストを等角風に描画しているが、建物詳細や操作のための統一 UI がなかった。

## 決定
- `src/components/BuildingOverlay.tsx` を新規作成し、オーバーレイを共通化する。
  - MUI Paper を使用。MD3 のテーマを尊重。
  - フルスクリーンの半透明バックドロップ上に、右側からスライドインするパネルとして表示。
  - 高さは 100%。幅は `sm` 以上で 500px、`sm` 未満で 100%。
  - 右上に Close（×）アイコンボタンを配置。バックドロップクリックでも閉じる。
- `TownStage` 内で建物クリックを検知して選択状態を保持し、`BuildingOverlay` を表示する。
  - `BuildingItem` に `onClick` と `cursor="pointer"` を付与できるよう拡張。
  - 選択中の建物名をタイトルに表示し、サンプルで属性値をいくつか表示。

## 影響範囲
- 追加: `src/components/BuildingOverlay.tsx`
- 変更: `src/components/BuildingItem.tsx`（`onClick` をサポート）
- 変更: `src/components/TownStage.tsx`（選択状態と Overlay の描画を追加）
- 既存のデータモデルやフックの API は変更なし。

## 代替案の検討
- MUI `Drawer` を使う案: 容易だが、バックドロップのクリック伝播制御やタイトルのレイアウトを細かく調整したいこと、MD3 の細かな見た目調整を柔軟に行うため `Paper` + 任意レイアウトを選択。
- `Dialog` を使う案: モバイル 100% 幅にしやすいが、右側パネルとしての常時 100% 高さ・固定配置の素直さは `Paper` 構成が勝ると判断。

## 実装メモ
- `useMediaQuery(theme.breakpoints.up('sm'))` で幅を切り替え。
- `Box` をバックドロップにして `onClick={onClose}`、パネル内クリックはイベントバブリングが来ないよう構造を分離（`Paper` に onClick は付与しない前提）。
- ZIndex は `theme.zIndex.modal` を採用し、ステージ上の Building より前面に確実に表示。

## テスト観点
- スマホ / デスクトップでの横幅切り替え。
- バックドロップクリックと右上 × の両方で閉じられること。
- スクロールが必要なコンテンツを想定し、`overflow: auto` で内部のみスクロール。

## 気持ち（ありすの感想）
ステージの世界観を壊さないように、右サイドからすっと現れる感じにしてみました。ますたぁが思い描く操作感に近づけていたら嬉しいです。もっと可愛いアクセントやアニメーションが欲しかったら、遠慮なく言ってくださいね。ありす、ちゃんと頑張ります！
